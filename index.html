<script>
const el = (id)=>document.getElementById(id);
const last={};

// Yeni anahtarsız API (Frankfurter)
async function getRate(from,to){
  const res = await fetch(`https://api.frankfurter.app/latest?from=${from}&to=${to}`);
  const data = await res.json();
  return data.rates[to];
}

function update(id,val){
  const v=parseFloat(val);
  const prev=last[id];
  last[id]=v;
  const e=el(id);
  e.textContent=v.toFixed(2);
  if(prev){
    if(v>prev) e.className="value up";
    else if(v<prev) e.className="value down";
    else e.className="value";
  }
}

async function refresh(){
  try{
    const [usd,eur,gbp,xauusd]=await Promise.all([
      getRate("USD","TRY"),
      getRate("EUR","TRY"),
      getRate("GBP","TRY"),
      getRate("XAU","USD") // Ons altın USD cinsinden gelir
    ]);
    const usdtry = usd; // zaten TRY
    const goldGram = (xauusd * usdtry) / 31.1035; // onsu gram-altın TRY’ye çevir
    update("usd",usdtry);
    update("eur",eur);
    update("gbp",gbp);
    update("gold",goldGram);
    el("time").textContent="Son güncelleme: "+new Date().toLocaleTimeString("tr-TR",{hour12:false});
  }catch(e){
    el("time").textContent="Veri alınamadı";
    console.error(e);
  }
}

refresh();
setInterval(refresh,10000);
</script>
